<!--样式-->
<style>
    .tab_position {
        position: relative;
    }

</style>

<section class="content-header">
    <h1 lang="text:repair_report_performance">
    </h1>
    <ol class="breadcrumb">
        <li><a href="#" lang="text:report"></a></li>
        <li class="active" lang="text:repair_report_performance"></li>
    </ol>
</section>

<section class="content">
    <div class="nav-tabs-custom">
        <!--标签页 Nav tabs-->
        <ul class="nav nav-tabs" role="tablist" id="myNavTabs">
            <!--<li role="presentation" class="active">-->
            <!--<a role="tab" data-toggle="tab" lang="text:device_performance" href="#tab_performance">设备绩效</a>-->
            <!--</li>-->
            <li role="presentation" class="active">
                <a role="tab" data-toggle="tab" lang="text:repair_statistics" href="#tab_statistics">维修统计</a>
            </li>
            <li role="presentation" class="tab_position">
                <a role="tab" data-toggle="tab" lang="text:repair_situation" href="#tab_trend">报修情况</a>
            </li>
        </ul>
        <!--标签页 Tab panes-->
        <div class="tab-content" id="myPanesTabs" style="padding-bottom: 0px;">
            <!-- 设备绩效 -->
            <div role="tabpanel" class="tab-pane row" id="tab_performance">
                <div class="col-md-12">
                    <div class="panel report-panel">
                        <div class="box box-solid" style="margin-bottom: 0px;box-shadow: 0px 0px;">
                            <!--加载数据等待-->
                            <div class="overlay" style="display: none;">
                                <i class="fa icon-refresh icon-spin"></i>
                            </div>
                            <div class="box-body">
                                <div class="row"><!--查询条件-->
                                    <div class="col-sm-12" style="padding-bottom: 10px;">
                                        <form class="form-inline">
                                            <!--左侧-->
                                            <div class="form-group has-feedback">
                                                <input type="text" class="form-control form-control-left input-sm"
                                                       id="performanceDate" readonly="readonly">
                                                <span class="glyphicon glyphicon-calendar form-control-feedback"
                                                      style="left: 0;"></span>
                                            </div>
                                            <div class="form-group" style="padding: 5px 0px;">
                                                <span>
                                                <label lang="text:site"></label>
                                                <input type="text" class="form-control input-sm">
                                                </span>
                                            </div>
                                            <div class="form-group" style="padding: 5px 0px;">
                                                <span>
                                                <label lang="text:device_type"></label>
                                                <input type="text" class="form-control input-sm">
                                                </span>
                                            </div>
                                            <!--右侧-->
                                            <div class="form-group box-tools pull-right">
                                                <div class="form-group just-btn">
                                                    <button type="button" class="btn btn-default btn-sm"
                                                            onclick="getEquipmentPerformanceType()"
                                                            data-toggle="tooltip"
                                                            title="查询" lang="title:query"><span
                                                            class="glyphicon glyphicon-search"></span>
                                                    </button>
                                                </div>
                                                <div class="btn-group">
                                                    <button type="button" class="btn btn-default btn-sm" title='导出'
                                                            data-toggle='tooltip' data-placement="bottom"
                                                            lang="title:export" onclick=""
                                                            data-permissionFilter="[29]">
                                                        <i class="icon-upload-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="box-body" id="device_statistics">
                                <div class="row"><!--查询条件-->
                                    <div class="col-sm-12" style="padding-bottom: 10px;" id="device_types">
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="panel report-panel" style="display: none;" id="devicesPanel">
                        <div class="box box-solid" style="margin-bottom: 0px;box-shadow: 0px 0px;">
                            <!--加载数据等待-->
                            <div class="overlay" style="display: none;">
                                <i class="fa icon-refresh icon-spin"></i>
                            </div>
                            <div class="box-body">
                                <div class="row"><!--查询条件-->
                                    <div class="col-sm-12" style="padding-bottom: 10px;">
                                        <form class="form-inline">
                                            <!--左侧-->
                                            <div class="form-group" style="padding: 5px 0px;">
                                                <span>
                                                    <label id="deviceTypeName"></label>
                                                </span>
                                                <span>
                                                    <label>设备名称</label>
                                                    <input type="text" id="deviceName" class="form-control input-sm">
                                                </span>
                                            </div>
                                            <!--右侧-->
                                            <div class="form-group box-tools pull-right">
                                                <div class="form-group just-btn">
                                                    <button type="button" class="btn btn-default btn-sm"
                                                            ng-click="" data-toggle="tooltip"
                                                            title="查询" lang="title:query"><span
                                                            class="glyphicon glyphicon-search"></span>
                                                    </button>
                                                </div>
                                                <div class="btn-group">
                                                    <button type="button" class="btn btn-default btn-sm" title='导出'
                                                            data-toggle='tooltip' data-placement="bottom"
                                                            lang="title:export" onclick=""
                                                            data-permissionFilter="[29]">
                                                        <i class="icon-upload-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="box-body">
                                <div class="row"><!--查询条件-->
                                    <div class="col-sm-12" style="padding-bottom: 10px;">
                                        <table class="table table-bordered table-hover table-striped">
                                            <thead>
                                            <tr>
                                                <th>设备名称</th>
                                                <th>设备位置</th>
                                                <th lang="text:asset_number"></th>
                                                <th>产能</th>
                                                <th>停机率</th>
                                            </tr>
                                            </thead>
                                            <tbody id="devicesData">
                                            <!--动态载入数据-->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <!-- 维修统计 -->
            <div role="tabpanel" class="tab-pane active row" id="tab_statistics">
                <div class="col-md-12">
                    <div class="panel report-panel">
                        <div class="box box-solid" style="margin-bottom: 0px;box-shadow: 0px 0px;">
                            <!--加载数据等待-->
                            <div class="overlay" style="display: none;">
                                <i class="fa icon-refresh icon-spin"></i>
                            </div>
                            <div class="box-body">
                                <div class="row">
                                    <div class="col-sm-12" style="padding-bottom: 10px;">
                                        <form class="form-inline">
                                            <!--左侧-->
                                            <div class="form-group has-feedback">
                                                <input type="text" class="form-control form-control-left input-sm"
                                                       id="statisticsDate" readonly="readonly">
                                                <span class="glyphicon glyphicon-calendar form-control-feedback"
                                                      style="left: 0;"></span>
                                            </div>
                                            <div class="form-group" style="padding: 5px 0px;">
                                                <span>
                                                    <label lang="text:site"></label>
                                                    <input type="text" class="form-control input-sm" lang="placeholder:site"
                                                           id="statisticsSite">
                                                </span>
                                            </div>
                                            <div class="form-group just-btn">
                                                <button type="button" class="btn btn-default btn-sm"
                                                        onclick="getMaintenanceStatistics()" data-toggle="tooltip"
                                                        title="查询" lang="title:query"><span
                                                        class="glyphicon glyphicon-search"></span>
                                                </button>
                                            </div>
                                            <!--右侧-->
                                            <!--<div class="form-group box-tools pull-right">-->
                                                <!--<div class="btn-group">-->
                                                <!--<button type="button" class="btn btn-default btn-sm" title='导出'-->
                                                <!--data-toggle='tooltip' data-placement="bottom"-->
                                                <!--lang="title:export" onclick="" data-permissionFilter="[29]">-->
                                                <!--<i class="icon-upload-alt"></i>-->
                                                <!--</button>-->
                                                <!--</div>-->
                                            <!--</div>-->
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel report-panel">
                        <div class="panel-body">
                            <div class="row">
                                <div id="repairStatusReport" class="col-md-6">
                                    <div class="box box-default">
                                        <div class="box-header with-border">
                                            <h3 class="box-title" lang="text:repair_state_monitor">维修状态监控</h3>
                                            <div class="box-tools pull-right">
                                                <button class="btn btn-box-tool" data-widget="collapse">
                                                    <i class="glyphicon glyphicon-minus"></i>
                                                </button>
                                            </div>
                                        </div><!-- /.box-header -->
                                        <div class="box-body">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="chart-responsive" style="height:380px;width:100%;"
                                                         id="statusChart">
                                                    </div><!-- ./chart-responsive -->
                                                </div><!-- /.col -->
                                            </div><!-- /.row -->
                                        </div><!-- /.box-body -->
                                    </div><!-- /.box -->
                                </div>
                                <div id="orderTypeReport" class="col-md-6">
                                    <div class="box box-default">
                                        <div class="box-header with-border">
                                            <h3 class="box-title" lang="text:order_type_statistics"> </h3>
                                            <div class="box-tools pull-right">
                                                <button class="btn btn-box-tool" data-widget="collapse">
                                                    <i class="glyphicon glyphicon-minus"></i>
                                                </button>
                                            </div>
                                        </div><!-- /.box-header -->
                                        <div class="box-body">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="chart-responsive" style="height:380px;width:100%;"
                                                         id="typeChart">
                                                    </div><!-- ./chart-responsive -->
                                                </div><!-- /.col -->
                                            </div><!-- /.row -->
                                        </div><!-- /.box-body -->
                                    </div><!-- /.box -->
                                </div>
                            </div>
                            <div id="repairStatusTable" class="mt-20">
                            </div>
                        </div>
                    </div>
                    <div class="panel report-panel">
                        <div class="panel-body">
                            <div id="faultCauseReport" class="mt-20">
                                <div class="box">
                                    <div class="box-header with-border">
                                        <h3 class="box-title" lang="text:device_fault_cause_analysis">设备故障原因分析</h3>
                                        <div class="box-tools pull-right">
                                            <button class="btn btn-box-tool" data-widget="collapse">
                                                <i class="glyphicon glyphicon-minus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="box-body">
                                        <div class="chart" style="height:300px;width:100%;" id="causeChart">
                                        </div>
                                    </div><!-- /.box-body -->
                                </div><!-- /.box -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 报修情况 -->
            <div role="tabpanel" class="tab-pane row" id="tab_trend">
                <div class="col-md-12">
                    <div class="panel report-panel">
                        <div class="box box-solid" style="margin-bottom: 0px;box-shadow: 0px 0px;">
                            <!--加载数据等待-->
                            <div class="overlay" style="display: none;">
                                <i class="fa icon-refresh icon-spin"></i>
                            </div>
                            <div class="box-body">
                                <div class="row"><!--查询条件-->
                                    <div class="col-sm-12" style="padding-bottom: 10px;">
                                        <form class="form-inline">
                                            <!--左侧-->
                                            <div class="form-group has-feedback">
                                                <input type="text" class="form-control form-control-left input-sm"
                                                       id="repairDate" readonly="readonly">
                                                <span class="glyphicon glyphicon-calendar form-control-feedback"
                                                      style="left: 0;"></span>
                                            </div>
                                            <div class="form-group" style="padding: 5px 0px;">
                                                <span>
                                                    <label lang="text:site"></label>
                                                    <input type="text" class="form-control input-sm"  lang="placeholder:site" id="repairSite">
                                                </span>
                                            </div>
                                            <div class="form-group just-btn">
                                                <button type="button" class="btn btn-default btn-sm"
                                                        onclick="getRepairSituation()" data-toggle="tooltip"
                                                        title="查询" lang="title:query"><span
                                                        class="glyphicon glyphicon-search"></span>
                                                </button>
                                            </div>
                                            <!--右侧-->
                                            <!--<div class="form-group box-tools pull-right">-->
                                                <!--<div class="btn-group">-->
                                                <!--<button type="button" class="btn btn-default btn-sm" title='导出'-->
                                                <!--data-toggle='tooltip' data-placement="bottom"-->
                                                <!--lang="title:export" onclick=""-->
                                                <!--data-permissionFilter="[29]">-->
                                                <!--<i class="icon-upload-alt"></i>-->
                                                <!--</button>-->
                                                <!--</div>-->
                                            <!--</div>-->
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel report-panel">
                        <div class="panel-body">
                            <div id="repairTrendReport" class="mt-20">
                                <div class="box ">
                                    <div class="box-header with-border">
                                        <h3 class="box-title" lang="text:device_repair_count_chart">设备报修数量走势图</h3>
                                        <div class="box-tools pull-right">
                                            <button class="btn btn-box-tool" data-widget="collapse">
                                                <i class="glyphicon glyphicon-minus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="box-body">
                                        <div class="chart" style="height:300px;width:100%;" id="trendChart">
                                        </div>
                                    </div><!-- /.box-body -->
                                </div><!-- /.box -->
                            </div>
                        </div>
                    </div>
                    <div class="panel report-panel">
                        <h3 class="box-title" lang="text:repair_situation_statistics_chart"></h3>
                        <div class="panel-body">
                            <div id="repairAnalysisReport">
                                <table class="table table-bordered table-hover table-striped">
                                    <thead>
                                    <tr>
                                        <th lang="text:site"></th>
                                        <th lang="text:asset_number"></th>
                                        <th lang="text:device_name"></th>
                                        <th lang="text:repair_count"></th>
                                        <th lang="text:already_closed"></th>
                                    </tr>
                                    </thead>
                                    <tbody id="repairContent">
                                    <!--动态载入数据-->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    var colorList = ["#FF7F00", "#B3EE3A", "#FF0000", "#436EEE", "#8968CD", "#BDB76B", "#ADD8E6", "#556B2F", "#00EEEE", "#9F79EE"];
    //生成随机颜色
    function randomColor() {
        return '#' +
                (function (color) {
                    return (color += '0123456789abcdef'[Math.floor(Math.random() * 16)])
                    && (color.length == 6) ? color : arguments.callee(color);
                })('');
    }

    //设备绩效子页面设备类型获取
    function getEquipmentPerformanceType() {
        var performanceDate = ($("#performanceDate").val()).split("-");
        var params = {};
        params.start = new Date(performanceDate[0]).getTime() / 1000;
        params.end = new Date(performanceDate[1]).getTime() / 1000;
        getDeviceTypes(params, true, function (data) {
            $("#device_types").empty();
            var deviceTypesAppend = "";
            for (var i = 0; i < data.length; i++) {
                var name = data[i].category;
                if (name == "unkown") {
                    name = locale.get("unknow");
                }
                deviceTypesAppend +=
                        '<div class="col-lg-2 col-xs-6">' +
                        '<div class="small-box" style="background-color:' + colorList[i] + '">' +
                        '<div class="inner"><h3>' + data[i].items.count + '</h3><p>' + name + '</p></div>' +
                        '<div class="icon"><i class="ion ion-pie-graph"></i></div>' +
                        '<a href="javascript:void(0)" onclick="getEquipmentPerformance(\'' + name + '\')" class="small-box-footer">' +
                        'More info <iclass="fa fa-arrow-circle-right"></i></a>' +
                        '</div></div>';
            }
            $("#device_types").append(deviceTypesAppend);
        });
    }

    //设备绩效子页面设备详细信息获取
    function getEquipmentPerformance(type) {
        var performanceDate = ($("#performanceDate").val()).split("-");
        var deviceNames = ($("#deviceNames").val());
        var params = {};
        params.start = new Date(performanceDate[0]).getTime() / 1000;
        params.end = new Date(performanceDate[1]).getTime() / 1000;

        getDeviceInfos(params, true, function (data) {
            $("#devicesPanel").show();
            $("#devicesData").empty();
            var deviceInfosAppend = "";
            for (var i = 0; i < data.length; i++) {
                var name = data[i].category;
                if (name == "unkown") {
                    name = locale.get("unknow");
                }
                deviceInfosAppend += "";
            }
            $("#devicesData").append(deviceInfosAppend);
        });
    }

    //维修统计子页面api结合
    function getMaintenanceStatistics() {
        //获取工单数量及完成情况
        var statisticsDate = ($("#statisticsDate").val()).split("-");
        var params = {};
        params.start = new Date(statisticsDate[0]).getTime() / 1000;
        params.end = new Date(statisticsDate[1]).getTime() / 1000;
        var name = $.trim($("#statisticsSite").val());
        if (name !== "") {
            name = name.match(pattern);
            params.site_name = name;
        }
        getOverviewData(params, true, function (data) {
            var workorderTypes = data.workorder_types;
            var states = data.states;
            statusChart.setOption({
                series: [{
                    name: locale.get("repair_state"),
                    data: [
                        {name: locale.get("new2"), value: states.created},
                        {name: locale.get("accepted") , value: states.accepted},
                        {name: locale.get("processing"), value: states.processing},
                        {name: locale.get("finished") , value: states.finished},
                        {name: locale.get("closed") , value: states.closed},
                        {name: locale.get("rejected") , value: states.rejected},
                        {name: locale.get("unkown") , value: states.unkown}

                    ]
                }]
            });
            typeChart.setOption({
                series: [{
                    name: locale.get("order_type"),
                    data: [
                        {name: locale.get("repair_schedule"), value: workorderTypes.pre_wos_sum},
                        {name: locale.get("artificial_service_work_sheet"), value: workorderTypes.rpt_wos_sum},
                        {name: locale.get("alarm_fault_repair_order"), value: workorderTypes.alm_wos_sum},
                        {name: locale.get("temporary_work_order"), value: workorderTypes.tmp_wos_sum},
                        {name: locale.get("unkown"), value: workorderTypes.unkown_wos_sum}
                    ]
                }]
            });
        }, this);
        //获取设备故障原因及数量
        getDeviceFailureData(params,true, function (data) {
            var causes = [];
            var counts = [];
            for (var i = 0; i < data.length; i++) {
                var cause = data[i].cause;
                var count = data[i].count;
                causes.push(cause);
                counts.push(count);
            }
            causeChart.setOption({
                legend: {
                    data: [locale.get("count")]
                },
                xAxis: [
                    {
                        type: 'category',
                        data: causes
                    }
                ],
                series: [
                    {
                        name: locale.get("count"),
                        type: 'bar',
                        data: counts
                    }
                ]
            });
        }, this);
    }

    //报修情况子页面api结合
    function getRepairSituation() {
        var repairDate = ($("#repairDate").val()).split("-");
        //获取设备报修数量情况
        var params = {};
        params.start = new Date(repairDate[0]).getTime() / 1000;
        params.end = new Date(repairDate[1]).getTime() / 1000;
        var name = $.trim($("#repairSite").val());
        if (name !== "") {
            name = name.match(pattern);
            params.site_name = name;
        }
        trendChart.showLoading(chartloading);
        getDeviceRepairData(params, true, function (data) {
            var times = [];
            var totals = [];
            var closeds = [];
            var alarms = [];
            var repairs = [];
            var unkowns = [];
            var preventives = [];
            var temporarys = [];
            for (var i = 0; i < data.length; i++) {
                times.push(data[i].key);
                totals.push(data[i].total);
                closeds.push(data[i].closed);
                alarms.push(data[i].alarm);
                repairs.push(data[i].repair);
                unkowns.push(data[i].unkown);
                preventives.push(data[i].preventive);
                temporarys.push(data[i].temporary);
            }

            trendChart.setOption({
                tooltip: {
                    trigger: 'axis'
                },
                toolbox: {
                    show: true,
                    feature: {
                        magicType: {show: true, type: ['line', 'bar']},
                        restore: {show: true},
                        saveAsImage: {show: true}
                    }
                },
                calculable: true,
                legend: {
                    data: [
                            locale.get("count")
//                            locale.get("closed"),
//                            locale.get("alarm"),
//                            locale.get("repair"),
//                            locale.get("unkown"),
//                            locale.get("preventive"),
//                            locale.get("temporary")
                        ]
                },
                xAxis: [
                    {
                        type: 'category',
                        boundaryGap: false,
                        data: times
                    }
                ],
                yAxis: [
                    {
                        type: 'value'
                    }
                ],
                series: [
                    {name: locale.get("count"), type: 'line', data: totals}
//                    {name: locale.get("closed"), type: 'line', data: closeds},
//                    {name: locale.get("alarm"), type: 'line', data: alarms},
//                    {name: locale.get("repair"), type: 'line', data: repairs},
//                    {name: locale.get("unkown"), type: 'line', data: unkowns},
//                    {name: locale.get("preventive"), type: 'line', data: preventives},
//                    {name: locale.get("temporary"), type: 'line', data: temporarys}
                ]
            });
            trendChart.hideLoading();
        }, this);

        getDeviceInfos(params, true, function (data) {
            $("#repairContent").empty();
            var repairContentAppend = "";
            for (var i = 0; i < data.length; i++) {
                repairContentAppend +=
                        '<tr>' +
                        '<td>' + data[i].key.site_name + '</td>' +
                        '<td>' + data[i].key.asset_no + '</td>' +
                        '<td>' + data[i].key.device_name + '</td>' +
                        '<td>' + data[i].total + '</td>' +
                        '<td>' + data[i].closed + '</td>' +
                        '</tr>';
            }
            $("#repairContent").append(repairContentAppend);
        });
    }

    function initDate() {
        /**
         * 时间
         */
        //日历插件显示日期初始化
        $('#statisticsDate').daterangepicker(
                {
                    startDate: moment().subtract(6, 'days'),
                    endDate: moment(),
                    maxDate: moment(),
                    showDropdowns: false,
                    showWeekNumbers: false,
                    separator: '-',
                    locale: {
                        format: 'YYYY/MM/DD',
                        separator: '-',
                        applyLabel: locale.get("apply"),
                        cancelLabel: locale.get("cancel")
                    }
                },
                function (start, end) {
                    $('#statisticsDate').val(start.format('YYYY/MM/DD') + '-' + end.format('YYYY/MM/DD'));
                }
        );
        $('#repairDate').daterangepicker(
                {
                    startDate: moment().subtract(6, 'days'),
                    endDate: moment(),
                    maxDate: moment(),
                    showDropdowns: false,
                    showWeekNumbers: false,
                    separator: '-',
                    locale: {
                        format: 'YYYY/MM/DD',
                        separator: '-',
                        applyLabel: locale.get("apply"),
                        cancelLabel: locale.get("cancel")
                    }
                },
                function (start, end) {
                    $('#repairDate').val(start.format('YYYY/MM/DD') + '-' + end.format('YYYY/MM/DD'));
                }
        );
        $('#performanceDate').daterangepicker(
                {
                    startDate: moment().subtract(6, 'days'),
                    endDate: moment(),
                    maxDate: moment(),
                    showDropdowns: false,
                    showWeekNumbers: false,
                    separator: '-',
                    locale: {
                        format: 'YYYY/MM/DD',
                        separator: '-',
                        applyLabel: locale.get("apply"),
                        cancelLabel: locale.get("cancel")
                    }
                },
                function (start, end) {
                    $('#repairDate').val(start.format('YYYY/MM/DD') + '-' + end.format('YYYY/MM/DD'));
                }
        );
    }

    var statusChart;
    var typeChart;
    var causeChart;
    var trendChart;
    var chartloading = {
        text: locale.get("the_chart_data_are_trying_to_load"),
        x: "center",
        y: "center",
        textStyle: {
            color: "white",
            fontSize: 14
        },
        effect: "spin"
    }

    function drawPerformanceChart() {
        var statusOption = {
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            toolbox: {
                show: true,
                feature: {
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            calculable: true,
            series: [
                {
                    name: locale.get("repair_state_monitor"),
                    type: 'pie',
                    radius: ['40%', '60%'],
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                formatter: "{b}\n{c}"+locale.get("ge")
                            },
                            labelLine: {
                                show: true
                            }
                        },
                        emphasis: {
                            label: {
                                show: true,
                                position: 'center',
                                textStyle: {
                                    fontSize: '18',
                                    //fontWeight : 'bold',
                                    fontColor: 'white'
                                }
                            }
                        }
                    },
                    data: [
                        {name: locale.get("create"), value: 0},
                        {name: locale.get("accepted"), value: 0},
                        {name: locale.get("processing"), value: 0},
                        {name: locale.get("finished"), value: 0},
                        {name: locale.get("closed"), value: 0},
                        {name: locale.get("rejected"), value: 0},
                        {name: locale.get("unkown"), value: 0}]
                }
            ],
            noDataLoadingOption: {
                text: locale.get("no_data"),
                effect: 'bubble',
                effectOption: {
                    effect: {
                        n: 0
                    }
                }
            }
        };
        var typeOption = {
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            toolbox: {
                show: true,
                feature: {
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            calculable: true,
            series: [
                {
                    name: locale.get("order_type_statistics"),
                    type: 'pie',
                    radius: ['40%', '60%'],
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                formatter: "{b}\n{c}"+locale.get("ge")
                            },
                            labelLine: {
                                show: true
                            }
                        },
                        emphasis: {
                            label: {
                                show: true,
                                position: 'center',
                                textStyle: {
                                    fontSize: '18',
                                    //fontWeight : 'bold',
                                    fontColor: 'white'
                                }
                            }
                        }
                    },
                    data: [
                        {name: locale.get("repair_schedule"), value: 0},
                        {name: locale.get("artificial_service_work_sheet"), value: 0},
                        {name: locale.get("alarm_fault_repair_order"), value: 0},
                        {name: locale.get("temporary_work_order"), value: 0},
                        {name: locale.get("unkown"), value: 0}]
                }
            ],
            noDataLoadingOption: {
                text: locale.get("no_data"),
                effect: 'bubble',
                effectOption: {
                    effect: {
                        n: 0
                    }
                }
            }
        };
        var barOptionstr = JSON.stringify(barOption);
        var lineOptionstr = JSON.stringify(lineOption);
        var causeOption = $.parseJSON(barOptionstr);
        var trendOption = $.parseJSON(lineOptionstr);

        require(
                [
                    'echarts',
                    'echarts/chart/line', // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
                    'echarts/chart/bar',
                    'echarts/chart/pie'
                ],
                function (ec) {
                    //echars 对tab分页的图表无法获取到width:100%的数值,只会转化为100px,这里统一取主级的div宽度并缩进一定百分比,赋给图表,如有更好的办法望交流改进
                    $("#statusChart").css('width', $("#myNavTabs").width() * 0.45);
                    $("#typeChart").css('width', $("#myNavTabs").width() * 0.45);
                    $("#causeChart").css('width', $("#myNavTabs").width() * 0.92);
                    $("#trendChart").css('width', $("#myNavTabs").width() * 0.92);

                    //维修状态监控
                    statusChart = ec.init(document.getElementById("statusChart"));
                    //图表显示提示信息
                    statusChart.showLoading(chartloading);
                    statusChart.setOption(statusOption);
                    statusChart.hideLoading();
                    //订单类型统计
                    typeChart = ec.init(document.getElementById("typeChart"));
                    typeChart.showLoading(chartloading);
                    typeChart.setOption(typeOption);
                    typeChart.hideLoading();
                    //设备故障原因分析
                    causeChart = ec.init(document.getElementById("causeChart"));
                    causeChart.showLoading(chartloading);
                    causeChart.setOption(causeOption);
                    causeChart.hideLoading();
                    //设备报修数量走势图
                    trendChart = ec.init(document.getElementById("trendChart"));

//                    trendChart.setOption(trendOption);

//                    getEquipmentPerformanceType();
                    getRepairSituation();
                    getMaintenanceStatistics();
                }
        );
    }
    $(document).ready(function () {
        initDate();
        require(['reportStatisticsService'], function () {
            drawPerformanceChart();
            locale.render({element: "#init_body"});
        });
    });

</script>