<script type="text/javascript">
    require(['echarts'], function(siteService) {


    });

    $('#zmjcs').multiselect();
     function end(){
        var mydate = new Date();
        var str = "" + mydate.getFullYear() + "-";
        str += (mydate.getMonth()+1) + "-";
        str += mydate.getDate();
        return str;
  }
      $("#endDate").val(end());
     function start(){
        var mydate = new Date();
        var str = "" + mydate.getFullYear() + "-";
        str += (mydate.getMonth()) + "-";
        str += mydate.getDate();
        return str;
  } 
    $("#startDate").val(start());

    var  varIds = $("#zmjcs").val();
    console.log(varIds);
    var  deviceId = "577c72b79e620b22b67465ac";
    var devices = [];
    var device = {
            "varIds":varIds,
            "deviceId":deviceId
    };
        devices.push(device);
        console.log(devices);
    loadAllPluckerData(devices,function(data){
                // len = data.result.length;
               // var x = data.result.vars.value;
                //var clogs = data.result;
                 mOption = {
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['工作效率']
                    },
                    toolbox: {
                        show: true,
                        feature: {
                            magicType: {show: true, type: ['line', 'bar']},
                            restore: {show: true},
                            saveAsImage: {show: true}
                        }
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: ['06-28','07-01','07-04','07-07','07-13','07-16','07-19','07-22','07-25','07-28']
                    },
                    yAxis: {
                        type: 'value',
                        axisLabel: {
                            formatter: '{value}'
                        }
                    },
                    series: [
                        {
                            name: '工作效率',
                            type: 'line',
                            data: [11, 11, 15, 13, 12, 13, 10,13,15,9],
                            markPoint: {
                                data: [
                                    {type: 'max', name: '最大值'},
                                    {type: 'min', name: '最小值'}
                                ]
                            },
                            markLine: {
                                data: [
                                    {type: 'average', name: '平均值'}
                                ]
                            }
                        }
                    ]
                };
                require(
                        [
                            'echarts',
                            'echarts/chart/line', // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
                            'echarts/chart/bar',
                            'echarts/chart/pie'
                        ],
                        function(ec) {
                            var gzxlchar = ec.init(document.getElementById("gzxl-char"));
                            gzxlchar.setOption(mOption);
                        }
                  );
    });
   
      
    
    function sureBtn() {
        var a = $('#zmjcs').val();
        console.log(a);
        if (a == null) {
            $("#allChars").empty();
            var xmylHtml = '<div class="row">' +
                    '<div class="col-md-12">' +
                    '<div class="box">' +
                    '<div class="box-header with-border">' +
                    '<span id="cltj_title_1"><h3 class="box-title">工作效率</h3></span>' +
                    '<div class="box-tools pull-right">' +
                    '<button class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse"><i class="icon-minus"></i></button>' +
                    '</div>' +
                    '</div>' +
                    '<div class="box-body">' +
                    '<div id="gzxl-char2" class="col-md-12 col-xs-12" style="height:350px;width:98%;padding:1px"  align="left">' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>';
            $("#allChars").append(xmylHtml);
            require(
                    [
                        'echarts',
                        'echarts/chart/line', // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
                        'echarts/chart/bar',
                        'echarts/chart/pie',
                    ],
                    function(ec) {
                        var gzxlChar2 = ec.init(document.getElementById("gzxl-char2"));
                        gzxlChar2.setOption(mOption);
                    }
            );

        } else {
            $("#allChars").empty();
            var c = a.length;
            var xmylHtml = '<div class="row">'
                    + '<div class="col-md-6">'
                    + '<div class="box">'
                    + '<div class="box-header with-border">' 
                    + '<span id="cltj_title_1"><h3 class="box-title">工作效率</h3></span>'
                    + '<div class="box-tools pull-right">'
                    + '<button class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse"><i class="icon-minus"></i></button>' 
                    + '</div>'
                    + '</div>' 
                    + '<div class="box-body">' 
                    + '<div id="gzxl-char1" class="col-md-12 col-xs-12" style="height:350px;width:98%;padding:1px"  align="left">' 
                    + '</div>' 
                    + '</div>' 
                    + '</div>' 
                    + '</div>';
            for (var i = 0; i < c; i++) {
                console.log(a[i]);
                var name = "";
                var id = "";
                if (a[i] == 400173) {
                    name = "吸棉压力";
                    id = "xmyl-char1";
                } else if (a[i] == 400164) {
                    name = "打手转速";
                    id = "dszs-char1";
                } else if (a[i] == 400159) {
                    name = "运转率";
                    id = "yzl-char1";
                } else if (a[i] == 400158) {
                    name = "抓臂高度";
                    id = "zbgd-char1";
                } else if (a[i] == 400171) {
                    name = "行走速度";
                    id = "xzsd-char1";
                } else if (a[i] == 400168) {
                    name = "塔身位置";
                    id = "tswz-char1";
                } else if (a[i] == 400170) {
                    name = "其他";
                    id = "qt-char1";
                }
                xmylHtml += '<div class="col-md-6">' +
                        '<div class="box">' +
                        '<div class="box-header with-border">' +
                        '<span id="cltj_title_1"><h3 class="box-title">' + name + '</h3></span>' +
                        '<div class="box-tools pull-right">' +
                        '<button class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse"><i class="icon-minus"></i></button>' +
                        '</div>' +
                        '</div>' +
                        '<div class="box-body">' +
                        '<div id="' + id + '" class="col-md-12 col-xs-12" style="height:350px;width:98%;padding:1px"  align="left">' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>';


            }
            xmylHtml += "</div>";
            $("#allChars").append(xmylHtml);
            
            var  varIds = $("#zmjcs").val();
            
            var  deviceId = "577c72b79e620b22b67465ac";
            loadAllPluckerData(varIds,deviceId,function(data){
                        var len = data.result.length;
                        console.log(len);
                        var clogs = data.result;
                        console.log(clogs);
            });
            
            require(
                    [
                        'echarts',
                        'echarts/chart/line', // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
                        'echarts/chart/bar',
                        'echarts/chart/pie',
                    ],
                    function(ec) {
                        var gzxlChar1 = ec.init(document.getElementById("gzxl-char1"));
                        gzxlChar1.setOption(mOption);
                        console.log(a);
                        var c = a.length;
                        for (var i = 0; i < c; i++) {
                            if (a[i] == 400173) {
                                var xmylChar1 = ec.init(document.getElementById("xmyl-char1"));
                                xmylChar1.setOption(mOption);
                            } else if (a[i] == 400164) {
                                var dszsChar1 = ec.init(document.getElementById("dszs-char1"));
                                dszsChar1.setOption(mOption);
                            } else if (a[i] == 400159) {
                                var yzlChar1 = ec.init(document.getElementById("yzl-char1"));
                                yzlChar1.setOption(mOption);
                            } else if (a[i] == 400158) {
                                var zbgdChar1 = ec.init(document.getElementById("zbgd-char1"));
                                zbgdChar1.setOption(mOption);
                            } else if (a[i] == 400171) {
                                var xzsdChar1 = ec.init(document.getElementById("xzsd-char1"));
                                xzsdChar1.setOption(mOption);
                            } else if (a[i] == 400168) {
                                var tswzChar1 = ec.init(document.getElementById("tswz-char1"));
                                tswzChar1.setOption(mOption);
                            } else if (a[i] == 400170) {
                                var qtChar1 = ec.init(document.getElementById("qt-char1"));
                                qtChar1.setOption(mOption);
                            }

                        }


                    }
            );

        }

    }
</script>
<!-- Main content -->
<section class="content-header">
    <h1>
        抓棉机
        <small>Version 2.0</small>
    </h1>

    <ol class="breadcrumb">
        <li><a href="javascript:void(0)" onclick="click2url(1)"><i class="icon-home"></i> Home</a></li>
    </ol>
</section>
<section class="content" id="tcontent">
    <div class="row">
        <div class="from-group" role="toolbar">
            <div class="col-md-2">
                <select id="zmj" class="form-control " style="width: 70%">
                    <option value="1">抓棉机</option>
                </select>
            </div>
            <div class="col-md-2">
               <!--<label class="col-md-6 control-label">参数选择</label>-->
                <select id="zmjcs" multiple="multiple">
                    <option value="400173" id="xm" selected="selected">吸棉压力</option>
                    <option value="400164" id="ds">打手转速</option>
                    <option value="400159" id="yz">运转率</option>
                    <option value="400158" id="zb">抓臂高度</option>
                    <option value="400171" id="xz">行走速度</option>
                    <option value="400168" id="ts">塔身位置</option>
                    <option value="400170" id="qt">其他</option>
                </select>                
            </div>

            <div class="col-md-3">
                <label class="col-sm-5 control-label" style="margin-top:6px;">开始日期</label>
                <div class="input-group date" >
                    <div class="input-group-addon">
                        <i class="icon-calendar"></i>
                    </div>
                    <input type="text"  id="startDate" data-provide="date-picker" class="form-control"  readonly="readonly"
                           onFocus="WdatePicker();">
                </div>

            </div>
            <div class="col-md-3">
                <label class="col-sm-5 control-label" style="margin-top:6px;">截止日期</label>
                <div class="input-group date">
                    <div class="input-group-addon">
                        <i class="icon-calendar"></i>
                    </div>
                    <input type="text"  id="endDate" data-provide="date-picker" class="form-control"  readonly="readonly"  onFocus="WdatePicker();"/>
                </div>
            </div>
            <div class="col-md-2">
                <button type="button" id="sureBtn" class="btn btn-default pull-left"  style="margin: 0px 15px;" onClick="sureBtn();">确定</button>
                <button type="button" class="btn btn-default pull-left"  style="display: none">导出</button>
            </div>
        </div>


    </div>

    <div id="allChars" style="margin-top: 20px;">
        <div class="row">
            <div class="col-md-12">
                <div class="box">
                    <div class="box-header with-border">
                        <h3 class="box-title">工作效率</h3>
                        <div class="box-tools pull-right">
                            <button class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse"><i class="icon-minus"></i></button>
                            <!--button class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove"><i class="icon-times"></i></button-->
                        </div>
                    </div>
                    <div class="box-body">
                        <div id="gzxl-char" class="col-md-12 col-xs-12" style="height:350px;width:98%;padding:1px"  align="left">

                        </div>
                    </div><!-- /.box-body -->
                </div><!-- /.box -->
            </div>
        </div>
    </div>

</section>